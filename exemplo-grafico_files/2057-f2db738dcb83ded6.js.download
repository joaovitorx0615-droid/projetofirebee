!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="eff17702-1666-4dba-8300-e11f912b0eb5",e._sentryDebugIdIdentifier="sentry-dbid-eff17702-1666-4dba-8300-e11f912b0eb5")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2057],{1557:function(e,t,n){n.d(t,{U:function(){return r}});let r=(0,n(52983).createContext)({})},79187:function(e,t,n){n.d(t,{u:function(){return k}});var r=n(97458),o=n(52983),a=n(23113),c=n(90312),l=n(91394),u=n(25288),s=n(19170),i=n(7616),d=n(45451);let f=()=>(0,o.useCallback)(e=>{let{collectionId:t,collectionName:n,fileId:r,location:o}=e;(0,d.sendGTMEvent)({collection_id:t,collection_name:n,event_name:"add_to_collection",event:"ga4event",file_id:r,location:o})},[]),v=()=>(0,o.useCallback)(e=>{let{location:t,fileId:n}=e;(0,d.sendGTMEvent)({event:"ga4event",event_name:"collect",location:t,file_id:n})},[]);var p=n(6418),h=n(63202);let w=async e=>{let{id:t,collectionId:n,resourceType:r}=e,o=new URLSearchParams;return o.append("collectionId",n.toString()),o.set("resourceType",r),await (0,h.c)("/api/user/resources/".concat(t,"/collections?").concat(o.toString()),"DELETE")},y=async e=>{let{id:t,collectionId:n,resourceType:r}=e;return await (0,h.c)("/api/user/resources/".concat(t,"/collections"),"POST",{collectionId:n,resourceType:r})};var m=n(94498),g=n(2983),b=n(58058),_=n.n(b),C=n(10893);let x=()=>{let{t:e}=(0,C.$G)("detailCommon");return(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2 px-4 py-2 text-sm text-surface-foreground-1",children:[(0,r.jsx)("span",{className:"whitespace-nowrap text-sm font-semibold text-surface-foreground-1",children:e("savedSuccessfully")}),(0,r.jsx)(_(),{href:"/user/collections",legacyBehavior:!0,children:(0,r.jsx)("span",{className:"cursor-pointer whitespace-nowrap text-xs font-normal !text-surface-foreground-accent-0",children:e("seeMyCollections")})})]})},E=e=>{let{type:t,id:n,location:d}=e,[h,b]=(0,o.useState)(null),_=(0,o.useRef)(!1),[C,E]=(0,o.useState)(!1),[N,I]=(0,o.useState)(null),S=(0,i.b9)(m.mX),T=f(),k=v(),R=(0,a.a)("smMax"),D=(0,l.d)(),O=(0,u.NL)(),j=(0,p.gx)(),{signUpUrl:P,setLoginCookies:G}=(0,c.e)(),{openToast:L}=(0,s.x_)(),U=(0,o.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!_.current||e)try{e?j():S(!0);let t=await O.fetchQuery((0,p.us)({page:1,resourceId:n}));I(t),_.current=!0}catch(e){console.error("Error fetching collections when opening the popover:",e)}finally{e||S(!1)}},[O,n,S,j]),Q=async()=>{if(!D){G(),window.location.href=P;return}(0,g.B)(t,"add_to_collection"),await U(),E(!0),k({location:d,fileId:n})},A=e=>b(t=>[...null!=t?t:[],e]),M=e=>b(t=>{var n;return null!==(n=null==t?void 0:t.filter(t=>t!==e))&&void 0!==n?n:[]}),B=(0,o.useCallback)(async(e,o)=>{try{A(e),await y({id:n,collectionId:e,resourceType:t}),T({fileId:n,collectionId:e,collectionName:o,location:d}),L({message:(0,r.jsx)(x,{}),showIcon:!1,showCloseButton:!1,position:R?"bottom-center":"top-right"}),await U(!0)}catch(e){console.error(e),L()}finally{M(e),R&&E(!1)}},[n,t,T,d,L,R,U]);return{responseCollections:N,collectionIdsLoading:h,isOpen:C,setIsOpen:E,onButtonOpenClick:Q,handleAddToCollection:B,handleRemoveFromCollection:(0,o.useCallback)(async e=>{try{A(e),await w({id:n,collectionId:e,resourceType:t}),await U(!0)}catch(e){console.error(e),L()}finally{M(e)}},[n,L,t,U]),handleOpenChange:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];E(e)}}};var N=n(99);let I=()=>{let{data:e,meta:{pagination:{nextPage:t}}}=(0,i.Dv)(m.HQ);return{collections:e,nextPage:t}},S=()=>{let{collections:e,nextPage:t}=I(),[n,r]=(0,o.useState)([]),a=(0,i.b9)(m.GD),c=(0,o.useRef)();(0,o.useEffect)(()=>{(null==e?void 0:e.length)>0&&r(e.map(N.V))},[e,t]);let l=null!==t,u=t=>{r((null==e?void 0:e.filter(e=>e.name.toLowerCase().includes(t.toLowerCase()))).map(N.V))},s=async e=>{c.current&&clearTimeout(c.current),c.current=setTimeout(async()=>{a(e)},350)};return{isSearchByApi:l,searchCollections:n,handleSearch:e=>{l?s(e):u(e)}}};var T=n(1557);let k=e=>{let{children:t,id:n,type:a,location:c}=e,{responseCollections:l,collectionIdsLoading:u,isOpen:s,setIsOpen:i,onButtonOpenClick:d,handleOpenChange:f,handleAddToCollection:v,handleRemoveFromCollection:p}=E({type:a,id:n,location:c}),{searchCollections:h,isSearchByApi:w,handleSearch:y}=S(),m=(0,o.useMemo)(()=>({id:n,type:a,searchCollections:h,responseCollections:l,collectionIdsLoading:u,isSearchByApi:w,isOpen:s,setIsOpen:i,handleSearch:y,handleAddToCollection:v,handleRemoveFromCollection:p,onButtonOpenClick:d,handleOpenChange:f}),[n,a,h,l,u,w,s,d,i,v,p,y,f]);return(0,r.jsx)(T.U.Provider,{value:m,children:t})}},88659:function(e,t,n){n.d(t,{r:function(){return a}});var r=n(52983),o=n(1557);let a=()=>(0,r.useContext)(o.U)},99:function(e,t,n){n.d(t,{V:function(){return r}});let r=e=>{var t,n;return{id:e.id,name:e.name,author:(null===(t=e.author)||void 0===t?void 0:t.name)||void 0,hasResourceInCollection:e.hasResourceInCollection,preview:null===(n=e.previews[0])||void 0===n?void 0:n.url}}},18377:function(e,t,n){n.d(t,{e:function(){return u},d:function(){return c.d}});var r=n(97458),o=n(53344),a=n.n(o),c=n(54565);let l=a()(()=>n.e(6106).then(n.bind(n,76106)).then(e=>e.EnabledClipboardNotSupportedAdvice),{loadableGenerated:{webpack:()=>[76106]},ssr:!1}),u=()=>(0,c.Q)()?null:(0,r.jsx)(l,{})},54565:function(e,t,n){n.d(t,{Q:function(){return a},d:function(){return c}});var r=n(7616);let o=(0,n(24399).cn)(!0),a=()=>(0,r.Dv)(o),c=()=>(0,r.b9)(o)},66209:function(e,t,n){n.d(t,{I:function(){return u},N:function(){return c.N}});var r=n(97458),o=n(53344),a=n.n(o),c=n(81087);let l=a()(()=>Promise.all([n.e(978),n.e(8512)]).then(n.bind(n,78512)).then(e=>e.ConfirmSafariClipboardComponent),{loadableGenerated:{webpack:()=>[78512]},ssr:!1}),u=()=>{let{onSucess:e}=(0,c.N)();return e&&(0,r.jsx)(l,{})}},81087:function(e,t,n){n.d(t,{N:function(){return a}});var r=n(7616);let o=(0,n(24399).cn)(null),a=()=>{let[e,t]=(0,r.KO)(o);return{onClose:()=>t(null),setConfirm:e=>t({onSuccess:e}),onSucess:null==e?void 0:e.onSuccess}}},55201:function(e,t,n){n.d(t,{h:function(){return r},l:function(){return o}});let r="sendToAISuiteEvent",o="/pikaso"},80719:function(e,t,n){n.d(t,{X:function(){return o}});var r=n(63202);let o=e=>{let{page:t,resourceId:n,searchTerm:o,collectionIds:a,ownership:c}=e,l=a?a.join(","):void 0,u={page:"".concat(t),...n&&{resourceId:"".concat(n)},...o&&{"filter[term]":o},...l&&{"filter[ids]":l},...c&&{"filter[ownership]":c}},s="/api/user/collections?".concat(new URLSearchParams(u));return(0,r.c)(s,"GET")}},6418:function(e,t,n){n.d(t,{us:function(){return i},lL:function(){return d},gx:function(){return f}});var r=n(78511),o=n(25288),a=n(7616),c=n(52983),l=n(80719),u=n(94498);let s=["collections","all"],i=e=>{let{page:t,searchTerm:n,resourceId:r}=e;return{queryKey:[...s,{page:t,resourceId:r,searchTerm:n}],queryFn:async()=>{let{data:e,success:o}=await (0,l.X)({page:t,resourceId:r,searchTerm:n});if(!o)throw Error(e);return e}}},d=e=>{let{page:t=1,resourceId:n}=e,o=(0,a.Dv)(u.GD);return(0,r.a)(i({page:t,searchTerm:o,resourceId:null!=n?n:null}))},f=()=>{let e=(0,o.NL)();return(0,c.useCallback)(()=>{e.invalidateQueries({queryKey:s})},[e])}},94498:function(e,t,n){n.d(t,{GD:function(){return o},HQ:function(){return a},mX:function(){return l},w0:function(){return c}});var r=n(24399);let o=(0,n(73139).rw)(null),a=(0,r.cn)({data:[],meta:{pagination:{nextPage:null,perPage:0,prevPage:null,currentPage:0}}}),c=(0,r.cn)([]),l=(0,r.cn)(!1)},2983:function(e,t,n){n.d(t,{B:function(){return o}});var r=n(26219);let o=(e,t)=>{if("3d"===e||"font"===e)return;"icon"!==e&&"video"!==e&&(e="regular");let n="send&event&detail&type=".concat(e,"&button_click=").concat(t,"&event_at=").concat(new Date().getTime());(0,r.O)(n)}},63202:function(e,t,n){n.d(t,{c:function(){return r}});let r=async(e,t,n,r)=>{let o=r?new Headers:void 0;return(null==r?void 0:r.locale)&&o&&o.set("accept-language",r.locale),(null==r?void 0:r.cache)&&o&&o.set("cache",r.cache),fetch(e,{method:t,...n&&{body:JSON.stringify(n)},...r&&{...r,headers:o}}).then(async e=>e.ok?{success:!0,data:204===e.status?null:await e.json()}:400===e.status?{success:!1,data:e.statusText}:401===e.status||405===e.status?{success:!1,data:"AUTHENTICATION_ERROR"}:403===e.status?{success:!1,data:"FORBIDDEN"}:500===e.status?{success:!1,data:"INTERNAL_SERVER_ERROR"}:404===e.status?{success:!1,data:"NOT_FOUND"}:429===e.status?{success:!1,data:"TOO_MANY_REQUESTS"}:{success:!1,data:await e.json()})}},11645:function(e,t,n){n.d(t,{u:function(){return a}});var r=n(52983),o=n(8147);let a=()=>{let e=(0,o.H)();return(0,r.useCallback)(t=>{if(!e)return!0;try{let n=e.disabledPermissionsTools;if(!n)return console.error(JSON.stringify({fatal_error:"Error checking tool permission for ".concat(t," from wallet ").concat(e.walletId),error:"Disabled permissions tools not found"})),!0;return!(t in n)}catch(n){return console.error(JSON.stringify({fatal_error:"Error checking tool permission for ".concat(t," from wallet ").concat(e.walletId),error:n})),!0}},[e])}}}]);